<section class="faq-description-section">
  {% if collection.description != blank %}
    <div class="description-block text-white bg-blue-200 px-6 py-10 text-center">
      {% if section.settings.heading != blank %}
        <h2 class="text-2xl font-bold mb-4">{{ section.settings.heading }}</h2>
      {% endif %}
      <div class="collection-description text-base leading-relaxed max-w-3xl mx-auto">
        {{ collection.description }}
      </div>
    </div>
  {% endif %}

{% assign faq_list = collection.metafields.custom.faqs %}
  <div class="faq-block bg-white py-10 px-4 max-w-3xl mx-auto">
    <h3 class="text-xl font-semibold mb-6 text-center">
      {{ section.settings.faq_heading | default: 'Frequently Asked Questions' }}
    </h3>
    <div class="accordion space-y-4">
      {% for faq_item in faq_list.refrences %}
        {% assign faq = faq_item.value %}
        <details class="border-b pb-3">
          <summary class="cursor-pointer font-semibold text-lg flex justify-between items-center">
            {{ faq.question }}
            <span class="text-gray-500">▼</span>
          </summary>
          <div class="mt-2 text-gray-600">
            {{ faq.answer }}
          </div>
        </details>
      {% endfor %}
    </div>
  </div>
{% assign faq_list = collection.metafields.custom.faqs %}

{% if faq_list and faq_list.references.size > 0 %}
  <ul>
    {% for faq_item in faq_list.references %}
      {% assign faq = faq_item.value %}
      <li>
        <strong>Q:</strong> {{ faq.question }}<br>
        <strong>A:</strong> {{ faq.answer }}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>No FAQs found for this collection.</p>
{% endif %}

</section>
{%- assign faq_list = collection.metafields.custom.faqs.value -%}

{% if faq_list %}
  <div class="faq-block bg-white py-10 px-4 max-w-3xl mx-auto">
    <h3 class="text-xl font-semibold mb-6 text-center">
      {{ section.settings.faq_heading | default: 'Frequently Asked Questions' }}
    </h3>
    <div id="faq-list" class="space-y-4"></div>
  </div>

  <script>
    const faqData = {{ faq_list | json }};

    const faqContainer = document.getElementById('faq-list');

    if (Array.isArray(faqData) && faqData.length > 0) {
      let html = '';
      faqData.forEach((faq, index) => {
        html += `
          <div class="faq-item border-b pb-3">
            <button class="faq-question flex justify-between items-center w-full text-left font-semibold text-lg">
              <span>${faq.question}</span>
              <span class="icon text-gray-500 transition-transform duration-300">▼</span>
            </button>
            <div class="faq-answer mt-2 text-gray-600 hidden">
              ${faq.answer}
            </div>
          </div>`;
      });
      faqContainer.innerHTML = html;

      // Add JS interaction
      faqContainer.querySelectorAll('.faq-question').forEach((btn) => {
        btn.addEventListener('click', function () {
          const answer = this.nextElementSibling;
          const icon = this.querySelector('.icon');

          // Toggle open/close
          if (answer.classList.contains('hidden')) {
            document.querySelectorAll('.faq-answer').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.icon').forEach(el => el.style.transform = 'rotate(0deg)');
            answer.classList.remove('hidden');
            icon.style.transform = 'rotate(180deg)';
          } else {
            answer.classList.add('hidden');
            icon.style.transform = 'rotate(0deg)';
          }
        });
      });
    } else {
      faqContainer.innerHTML = "<p>No FAQs available.</p>";
    }
  </script>
{% endif %}

{% schema %}
{
  "name": "Collection desc and FAQ",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Main Heading",
      "default": "Best Selling Treatments And Serums"
    },
    {
      "type": "text",
      "id": "faq_heading",
      "label": "FAQ Heading",
      "default": "Frequently Asked Questions"
    }
  ],
  "presets": [
  {
    "name": "Collection desc with FAQ"
  }
]

}
{% endschema %}
