{%- liquid
  assign color_scheme = section.settings.color_scheme
  assign bg_color = false

  if color_scheme == '1'
    assign bg_color = settings.color_scheme_1_bg
    assign bg_gradient = settings.color_scheme_1_gradient
  elsif color_scheme == '2'
    assign bg_color = settings.color_scheme_2_bg
    assign bg_gradient = settings.color_scheme_2_gradient
  elsif color_scheme == '3'
    assign bg_color = settings.color_scheme_3_bg
    assign bg_gradient = settings.color_scheme_3_gradient
  endif

  if bg_gradient != blank
    assign bg_color = true
  elsif bg_color == blank or bg_color == 'rgba(0,0,0,0)' or bg_color == settings.bg_color
    assign bg_color = false
  endif
-%}

<section class="faq-description-section section">
  <div class="{% if section.settings.full_width or bg_color %}container {% endif %} ">
    {%- if collection.description != blank -%}
      <div class="description-block text-white bg-blue-200 px-6 py-10 container {% unless color_scheme == 'none' %} color-scheme color-scheme--{{ color_scheme }}{% endunless %}">
        {% if section.settings.heading != blank %}
          <h2 class="text-2xl font-bold mb-4 text-current">{{ section.settings.heading }}</h2>
        {% endif %}
        <div class="collection-description text-base leading-relaxed max-w-3xl mx-auto">
          {{ collection.description }}
        </div>
      </div>
    {%- endif -%}

    {%- assign faq_list = collection.metafields.custom.faqs.value -%}

    {% if faq_list %}
      <div class="faq-block bg-white py-10 container {% unless color_scheme == 'none' %} color-scheme color-scheme--{{ color_scheme }}{% endunless %}">
        <h3 class="text-xl font-semibold mb-6 text-current">
          {{ section.settings.faq_heading | default: 'Frequently Asked Questions' }}
        </h3>
        <div id="faq-list" class="space-y-4"></div>
      </div>
    {% endif %}
  </div>
</section>

<script>
  const faqData = {{ faq_list | json }};
  const faqContainer = document.getElementById('faq-list');

  if (Array.isArray(faqData) && faqData.length > 0) {
    let html = '';
    faqData.forEach((faq) => {
      html += `
        <div class="faq-item border-b pb-3">
          <button class="faq-question flex justify-between items-center w-full text-left font-semibold text-lg">
            <span>${faq.question}</span>
            <span class="icon text-gray-500 transition-transform duration-300">â–¼</span>
          </button>
          <div class="faq-answer mt-2 text-gray-600 hidden">
            ${faq.answer}
          </div>
        </div>`;
    });
    faqContainer.innerHTML = html;

    faqContainer.querySelectorAll('.faq-question').forEach((btn) => {
      btn.addEventListener('click', function () {
        const answer = this.nextElementSibling;
        const icon = this.querySelector('.icon');

        const isOpen = answer.classList.contains('hidden');

        document.querySelectorAll('.faq-answer').forEach(el => el.classList.add('hidden'));
        document.querySelectorAll('.icon').forEach(el => el.style.transform = 'rotate(0deg)');

        if (!isOpen) {
          answer.classList.remove('hidden');
          icon.style.transform = 'rotate(180deg)';
        }
      });
    });
  } else {
    faqContainer.innerHTML = "<p>No FAQs available.</p>";
  }
</script>

{% schema %}
{
  "name": "Collection desc and FAQ",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Main Heading",
      "default": "Best Selling Treatments And Serums"
    },
    {
      "type": "text",
      "id": "faq_heading",
      "label": "FAQ Heading",
      "default": "Frequently Asked Questions"
    },
     {
      "type": "select",
      "id": "color_scheme",
      "label": "Color scheme",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "1",
          "label": "Scheme 1"
        },
        {
          "value": "2",
          "label": "Scheme 2"
        },
        {
          "value": "3",
          "label": "Scheme 3"
        }
      ],
      "default": "none"
    }
  ],
  "presets": [
  {
    "name": "Collection desc with FAQ"
  }
]

}
{% endschema %}
